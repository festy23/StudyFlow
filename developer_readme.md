# Project Development Guide

Этот документ описывает правила разработки, которых необходимо придерживаться при работе над проектом.

---

## Архитектура

- Проект состоит из отдельных микросервисов на Go.
- Внутреннее взаимодействие между сервисами — gRPC.
- Внешние клиенты работают через API Gateway (REST).
- Хранилище данных — PostgreSQL.
- Кэширование — Redis.
- Межсервисные события — Kafka.
- Файлы — S3-совместимое хранилище (доступ через file-service).

---

## Логирование

- Используется [zap](https://github.com/uber-go/zap)
- Каждый внешний запрос получает UUIDv7 в API Gateway. Он прокидывается дальше через gRPC метаданные.
- Что логировать
  - Входящие grpc запросы (interceptor в common_library)
  - Исходящие вызовы к другим сервисам
  - Создание, обновление, удаление сущностей
  - Retry, circuit breaker
  - Старт/остановка сервиса
  - Подключение к внешним системам (Postgres, Kafka, Redis)


---

## Тестирование

- Обязательное покрытие unit-тестами не менее 30% на каждый пакет.
- Все внешние зависимости мокаются.


---

## Отказоустойчивость

- Все исходящие запросы к другим сервисам оборачиваются в retry с exponential backoff.
- В имплементации каждого метода используется circuit breaker с порогами по количеству ошибок и таймаутов.

---

## Кэширование

TBD

---

## Безопасность

- Авторизация осуществляется через API Gateway.
- Внутренние сервисы доверяют gRPC контексту с авторизационной информацией.
- Все входящие данные валидируются (protobuf и кастомная логика).
- Секреты не хранятся в коде. Используются переменные окружения.

---

## CI/CD

TBD
